<!DOCTYPE html><html>	<head>		<meta charset="utf-8">		<meta name="viewport" content="width=device-width">		<title>DemoTwo</title>		<script src="bower_components/react/react.js"></script>		<script src="bower_components/react/JSXTransformer.js"></script>        <script src="node_modules/scroller/lib/animate.js"></script>        <script src="node_modules/scroller/lib/Scroller.js"></script>    </head>	<body style="margin: 0px">		<div id="example"></div>		<script type="text/jsx">            var backgroundImageUrl = ["1.jpg", "2.jpg", "3.jpg", "4.jpg"];            var colorArray = ["#666666", "#555555", "#444444", "#333333",            "#444444", "#555555", "#666666", "#666666", "#666666", "#666666", "#666666", "#666666", "#666666"];            var CellView = React.createClass({                getInitialState: function () {                    return {}                },                render: function() {                    return (<div style={this.props.style}                            >{"guoshencheng" + this.props.id}                    <img style={{width:"100%"}} src={backgroundImageUrl[this.props.id]}></img>                    </div>);                }            });            var ListView = React.createClass({                propTypes: {                    style: React.PropTypes.object,                    snapping: React.PropTypes.bool,                    scrollingDeceleration: React.PropTypes.number,                    scrollingPenetrationAcceleration: React.PropTypes.number,                    onScroll: React.PropTypes.func,                },                getInitialState: function () {                    return {scrollTop:0}                },                getDefaultProps: function () {                    return {                        style: { left: 0, top: 0, width: 320, height: 568 },                        snapping: false,                        scrollingDeceleration: 0.95,                        scrollingPenetrationAcceleration: 0.08                    };                },                componentDidMount: function () {                    this.createScroller();                    this.updateScrollingDimensions();                },                createScroller: function () {                    var options = {                        scrollingX: false,                        scrollingY: true,                        decelerationRate: this.props.scrollingDeceleration,                        penetrationAcceleration: this.props.scrollingPenetrationAcceleration                    };                    this.scroller = new Scroller(this.handleScroll, options);                },                updateScrollingDimensions: function () {                    var width = this.props.style.width;                    var height = this.props.style.height;                    var scrollWidth = width;                    var scrollHeight = this.props.itemCount * this.props.itemHeight;                    this.scroller.setDimensions(width, height, scrollWidth, scrollHeight);                },                handleTouchStart: function (e) {                    if (this.scroller) {                        this.scroller.doTouchStart(e.touches, e.timeStamp);                    }                },                handleTouchMove: function (e) {                    if (this.scroller) {                        e.preventDefault();                        this.scroller.doTouchMove(e.touches, e.timeStamp, e.scale);                    }                },                handleTouchEnd: function (e) {                    if (this.scroller) {                        this.scroller.doTouchEnd(e.timeStamp);                        if (this.props.snapping) {                            this.updateScrollingDeceleration();                        }                    }                },                handleScroll: function (left, top) {                    this.setState({ scrollTop: top });                    if (this.props.onScroll) {                        this.props.onScroll(top);                    }                },                getVisibleItemIndexes: function () {                    var itemIndexes = [];                    var itemHeight = this.props.itemHeight;                    var itemCount = this.props.itemCount;                    var scrollTop = this.state.scrollTop;                    var itemScrollTop = 0;                    for (var index=0; index < itemCount; index++) {                        itemScrollTop = (index * itemHeight) - scrollTop;                        //itemScrollTop = (index * itemHeight) - 0;                        // Item is completely off-screen bottom                        var propsHeight = parseInt(this.props.style.height);                        if (itemScrollTop >= propsHeight) {                            continue;                        }                        // Item is completely off-screen top                        if (itemScrollTop <= -propsHeight) {                            continue;                        }                        // Part of item is on-screen.                        itemIndexes.push(index);                    }                    return itemIndexes;                },                updateScrollingDeceleration: function () {                    var currVelocity = this.scroller.__decelerationVelocityY;                    var currScrollTop = this.state.scrollTop;                    var targetScrollTop = 0;                    var estimatedEndScrollTop = currScrollTop;                    while (Math.abs(currVelocity).toFixed(6) > 0) {                        estimatedEndScrollTop += currVelocity;                        currVelocity *= this.props.scrollingDeceleration;                    }                    // Find the page whose estimated end scrollTop is closest to 0.                    var closestZeroDelta = Infinity;                    var pageHeight = this.props.itemHeight;                    var pageCount = this.props.itemCount;                    var pageScrollTop;                    for (var pageIndex=0, len=pageCount; pageIndex < len; pageIndex++) {                        pageScrollTop = (pageHeight * pageIndex) - estimatedEndScrollTop;                        if (Math.abs(pageScrollTop) < closestZeroDelta) {                            closestZeroDelta = Math.abs(pageScrollTop);                            targetScrollTop = pageHeight * pageIndex;                        }                    }                    this.scroller.__minDecelerationScrollTop = targetScrollTop;                    this.scroller.__maxDecelerationScrollTop = targetScrollTop;                    this.scroller.__publish(0,targetScrollTop,1,true);                },                renderOneCell: function (index) {                    var itemHeight = this.props.itemHeight;                    var style = {                        position: "absolute",                        top: (index * itemHeight) - this.state.scrollTop + "px",                        left: 0,                        width: this.props.style.width,                        height: itemHeight,                        zIndex: index,                        background:colorArray[index]                    }                    return (<CellView id={index} style={style} key={index}>guoshencheng</CellView>);                },                render: function() {                    var items = this.getVisibleItemIndexes().map(this.renderOneCell);                    return React.createElement('div', {                                style: this.props.style,                                onTouchStart: this.handleTouchStart,                                onTouchMove: this.handleTouchMove,                                onTouchEnd: this.handleTouchEnd,                                onTouchCancel: this.handleTouchEnd                            }                            , items);                }            });            React.render(                <ListView snapping="true" itemCount={backgroundImageUrl.length} itemHeight="500" style={{height: 568, width:320}}>guoshencheng</ListView>,                document.getElementById("example")            );		</script>	</body></html>